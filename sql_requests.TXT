1.

SELECT *,
(SELECT orders.customer_id FROM orders WHERE orders.id = order_details.order_id) AS customer_id
FROM order_details;

2.

SELECT *
FROM order_details
WHERE order_id IN (SELECT id FROM orders WHERE shipper_id = 3)

3.

SELECT order_id, AVG(quantity) AS avg_quantity
FROM (SELECT * FROM order_details WHERE quantity > 10 ) AS temp_table
GROUP BY order_id;

4.

WITH TemporalTable AS (
    SELECT *
    FROM order_details
    WHERE quantity > 10
)
SELECT order_id, AVG(quantity) AS avg_quantity
FROM TemporalTable
GROUP BY order_id;

5.

DROP FUNCTION IF EXISTS DivideNumbers;

DELIMITER //

CREATE FUNCTION DivideNumbers(num1 FLOAT, num2 FLOAT)
RETURNS FLOAT
DETERMINISTIC 
BEGIN
    IF num2 = 0 THEN
        RETURN NULL;
    ELSE
        RETURN num1 / num2;
    END IF;
END //

DELIMITER ;

SELECT *, DivideNumbers(quantity, 2.0) AS divided_quantity
FROM order_details;